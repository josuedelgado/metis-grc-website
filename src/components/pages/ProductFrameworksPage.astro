---
import PageHero from '../shared/PageHero.astro';
import CTASection from '../shared/CTASection.astro';
import AnimatedSection from '../shared/AnimatedSection.tsx';
import { useTranslations } from '../../lib/i18n';

const { t, td } = useTranslations(Astro.currentLocale);

const frameworks = td<{ name: string; subtitle: string; desc: string }[]>('productFrameworks.supported.frameworks');
const mappingFeatures = td<string[]>('productFrameworks.mapping.features');
---

<PageHero title={t('productFrameworks.hero.title')} subtitle={t('productFrameworks.hero.subtitle')} dark />

<!-- Supported Frameworks -->
<section class="py-20 bg-background">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <AnimatedSection client:visible>
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-text-primary mb-4">{t('productFrameworks.supported.title')}</h2>
        <p class="text-text-muted max-w-2xl mx-auto">{t('productFrameworks.supported.subtitle')}</p>
      </div>
    </AnimatedSection>

    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
      {frameworks.map((fw, i) => (
        <AnimatedSection client:visible delay={i * 0.1}>
          <div class="bg-white rounded-[12px] p-6 shadow-card hover:shadow-card-hover transition-shadow h-full">
            <h3 class="text-lg font-bold text-text-primary mb-1">{fw.name}</h3>
            <p class="text-xs text-text-muted font-mono mb-3">{fw.subtitle}</p>
            <p class="text-sm text-text-muted leading-relaxed">{fw.desc}</p>
          </div>
        </AnimatedSection>
      ))}
    </div>

    <AnimatedSection client:visible>
      <div class="mt-8 text-center">
        <div class="inline-flex items-center gap-2 bg-white rounded-full px-5 py-2.5 shadow-card text-sm">
          <svg class="w-4 h-4 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
          <span class="text-text-muted" set:html={t('productFrameworks.supported.customNote')} />
        </div>
      </div>
    </AnimatedSection>
  </div>
</section>

<!-- Cross-Framework Mapping -->
<section class="py-20 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <AnimatedSection client:visible>
      <div class="grid md:grid-cols-2 gap-12 items-center">
        <div>
          <h2 class="text-2xl font-bold text-text-primary mb-4">{t('productFrameworks.mapping.title')}</h2>
          <p class="text-text-muted leading-relaxed mb-6">{t('productFrameworks.mapping.desc')}</p>
          <div class="space-y-4">
            {mappingFeatures.map((f) => (
              <div class="flex items-center gap-3 text-sm text-text-primary">
                <svg class="w-5 h-5 text-success shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                {f}
              </div>
            ))}
          </div>
        </div>
        <!-- Mapping visualization -->
        <div class="bg-background rounded-2xl border border-border p-6">
          <div class="space-y-3">
            {[
              { from: 'NIS2 Art. 21(2)(a)', to: ['ISO A.5.1', 'NIST GV.PO-01', 'CIS 1'] },
              { from: 'NIS2 Art. 21(2)(b)', to: ['ISO A.5.23', 'NIST ID.RA-01', 'CIS 16'] },
              { from: 'NIS2 Art. 21(2)(d)', to: ['ISO A.8.9', 'NIST PR.DS-01', 'CIS 3'] },
            ].map((mapping) => (
              <div class="bg-white rounded-lg p-3 border border-border">
                <div class="text-xs font-mono font-medium text-primary mb-2">{mapping.from}</div>
                <div class="flex flex-wrap gap-1.5">
                  {mapping.to.map((t: string) => (
                    <span class="inline-flex items-center text-xs bg-secondary-50 text-secondary-700 rounded px-2 py-0.5 font-mono">{t}</span>
                  ))}
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </AnimatedSection>
  </div>
</section>

<CTASection title={t('productFrameworks.cta.title')} subtitle={t('productFrameworks.cta.subtitle')} />
